# ================================================
# WHATICKET - WhatsApp Business API Oficial
# Exemplo de Configuração
# ================================================

# ------------------------------------------------
# WhatsApp Business API (Meta)
# ------------------------------------------------
# Obter em: https://business.facebook.com/

# ID do número de telefone no WhatsApp Business
WABA_PHONE_NUMBER_ID=1234567890

# Token de acesso da aplicação Meta
# Válido por 60 dias (renovar periodicamente)
WABA_ACCESS_TOKEN=EAAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ID da conta Business
WABA_BUSINESS_ACCOUNT_ID=9876543210

# Token personalizado para verificação do webhook
# Criar um valor único e secreto
WABA_WEBHOOK_VERIFY_TOKEN=meu_token_super_secreto_123_xyz

# (Opcional) Secret para validar assinatura de webhooks
WABA_WEBHOOK_SECRET=outro_secret_aqui

# Versão da API do Facebook Graph
# Recomendado: usar versão estável mais recente
WABA_API_VERSION=v18.0

# ------------------------------------------------
# Configurações de Comportamento
# ------------------------------------------------

# Habilitar API oficial globalmente (true/false)
WABA_ENABLED=true

# Timeout para requisições à API (milissegundos)
WABA_REQUEST_TIMEOUT=30000

# Número máximo de tentativas em caso de erro
WABA_MAX_RETRIES=3

# Delay entre tentativas (milissegundos)
WABA_RETRY_DELAY=2000

# ------------------------------------------------
# Webhooks
# ------------------------------------------------

# URL base do seu servidor (sem barra final)
# Exemplo: https://api.meudominio.com.br
BACKEND_URL=https://seu-dominio.com

# Porta do webhook (se diferente do backend principal)
WABA_WEBHOOK_PORT=8080

# Path do webhook (será: BACKEND_URL + WABA_WEBHOOK_PATH)
WABA_WEBHOOK_PATH=/webhooks/whatsapp

# ------------------------------------------------
# Rate Limiting
# ------------------------------------------------

# Máximo de mensagens por segundo
WABA_RATE_LIMIT_PER_SECOND=10

# Máximo de mensagens por minuto
WABA_RATE_LIMIT_PER_MINUTE=600

# ------------------------------------------------
# Logging e Debug
# ------------------------------------------------

# Nível de log para API oficial
# Opções: error, warn, info, debug
WABA_LOG_LEVEL=info

# Salvar payloads de webhook em arquivo (desenvolvimento)
WABA_DEBUG_WEBHOOKS=false

# Salvar requests/responses da API (desenvolvimento)
WABA_DEBUG_API_CALLS=false

# ------------------------------------------------
# Recursos Avançados
# ------------------------------------------------

# Habilitar envio de templates (requer aprovação Meta)
WABA_TEMPLATES_ENABLED=true

# Habilitar botões interativos
WABA_INTERACTIVE_BUTTONS_ENABLED=true

# Habilitar listas interativas
WABA_INTERACTIVE_LISTS_ENABLED=true

# Habilitar marcação de mensagens como lidas
WABA_MARK_AS_READ=true

# ------------------------------------------------
# Fallback e Redundância
# ------------------------------------------------

# Se API oficial falhar, usar Baileys automaticamente
WABA_FALLBACK_TO_BAILEYS=true

# Tempo para considerar API offline (segundos)
WABA_HEALTH_CHECK_INTERVAL=60

# ------------------------------------------------
# Custos e Limites (informativo)
# ------------------------------------------------

# Tier atual da conta (informativo, não afeta código)
# Tiers: 1 (250/dia), 2 (1000/dia), 3 (10000/dia), 4 (100000/dia), unlimited
WABA_ACCOUNT_TIER=1

# Custo aproximado por conversa (BRL)
WABA_COST_PER_CONVERSATION=0.17

# Alertar quando atingir N% do limite diário
WABA_ALERT_THRESHOLD_PERCENT=80

# ================================================
# CONFIGURAÇÕES EXISTENTES DO WHATICKET
# (manter como está)
# ================================================

# Baileys (mantém funcionalidade existente)
SESSIONS_DIR=private/sessions

# Banco de dados
DB_DIALECT=postgres
DB_HOST=localhost
DB_PORT=5432
DB_NAME=whaticket
DB_USER=postgres
DB_PASS=efe487b6a861100fb704ad9f5c160cb8

# Redis
REDIS_URI=redis://localhost:6379
REDIS_URI_MSG_CONN=

# Socket.IO
PORT=8080

# Frontend
FRONTEND_URL=http://localhost:3000
BACKEND_URL=http://localhost:8080

# JWT
JWT_SECRET=seu_jwt_secret_aqui
JWT_REFRESH_SECRET=seu_jwt_refresh_secret_aqui

# ================================================
# INSTRUÇÕES DE USO
# ================================================

# 1. Copiar este arquivo para backend/.env
# 2. Substituir todos os valores de exemplo
# 3. Executar: npm run db:migrate
# 4. Reiniciar backend: npm run dev
# 5. Testar com: npx ts-node test-official-api.ts

# ================================================
# SEGURANÇA
# ================================================

# ⚠️ IMPORTANTE:
# - NUNCA commitar este arquivo com valores reais
# - Adicionar .env ao .gitignore
# - Usar variáveis de ambiente em produção
# - Renovar tokens periodicamente (60 dias)
# - Manter webhook secret seguro

# ================================================
